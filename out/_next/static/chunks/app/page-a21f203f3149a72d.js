(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{58324:function(e,t,n){Promise.resolve().then(n.bind(n,21963))},72895:function(e,t,n){"use strict";let a=n(17076),s=n(85061),i=n(24717);e.exports={networkMappingAddresses:a,abiNftMarketplace:s,abiERC721:i}},34377:function(e,t,n){"use strict";n.d(t,{v:function(){return p}});var a=n(54463),s=n(62536),i=n(16491),r=n(8483),o=n(80755),d=n(14854);let p=(0,a._)({chains:[i.R,r.F,o.y,d.c],transports:{[i.R.id]:(0,s.d)(),[r.F.id]:(0,s.d)(),[o.y.id]:(0,s.d)(),[d.c.id]:(0,s.d)()}})},21963:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var a=n(57437);n(66648);var s=n(26735),i=n(72895),r=n(34377),o=n(42467),d=n(2265),p=n(83927),l=n(61572),u=n(10549),y=n(42921),c=n(58569),m=n(61160),f=n(77655),g=n(73336),x=n(60479),T=n(46717),b=n(28509),h=n(98286);function v(e){let{nftAddress:t,tokenId:n,isVisible:o,marketplaceAddress:p,onClose:v,imageURL:k,currentPrice:w,seller:M}=e,[N,I]=(0,d.useState)(0),{address:j}=(0,s.m)(),A=M.toLowerCase()===j.toLowerCase(),_=((0,h.x)(),1),[L,C]=c.ZP.useMessage(),[F,S]=(0,d.useState)(!1),{isPending:E,writeContract:P}=(0,x.S)(),B={abi:i.abiNftMarketplace,address:p,functionName:"buyItem",args:[t,BigInt(n)],value:w};async function O(e){L.destroy(),S(!0),L.open({type:"loading",content:"Waiting for block Confirmations...",duration:0}),await (0,T.e)(r.v,{hash:e,confirmations:_}),L.destroy(),L.open({type:"success",content:"Buy Item confirmed!"})}let R={abi:i.abiNftMarketplace,address:p,functionName:"updateListing",args:[t,BigInt(n),BigInt((0,b.f)(String(N||"0")))]},Z={abi:i.abiNftMarketplace,address:p,functionName:"cancelListing",args:[t,BigInt(n)]};async function U(e){L.destroy(),L.open({type:"loading",content:"Waiting for block Confirmations...",duration:0}),S(!0),await (0,T.e)(r.v,{hash:e,confirmations:_}),L.destroy(),S(!1),v&&v(),I("0"),L.open({type:"success",content:"Update Listing confirmed!"})}async function W(e){L.destroy(),L.open({type:"loading",content:"Waiting for block Confirmations...",duration:0}),S(!0),await (0,T.e)(r.v,{hash:e,confirmations:_}),L.destroy(),S(!1),v&&v(),L.open({type:"success",content:"Cancel Listing confirmed!"})}return(0,a.jsxs)(a.Fragment,{children:[C,(0,a.jsx)(m.Z,{open:o,onCancel:()=>{v(),I("0")},onOk:A?()=>{L.open({type:"loading",content:"Wait for confirming...",duration:0}),console.log("priceToUpdateListingWith:",N),console.log("price:",BigInt((0,b.f)(String(N||"0")))),P(R,{onError:e=>{var t;console.log(null!==(t=e.message)&&void 0!==t?t:e.shortMessage),L.destroy(),L.open({type:"error",content:e.shortMessage})},onSuccess:async e=>await U(e)})}:()=>{L.open({type:"loading",content:"Wait for confirming...",duration:0}),P(B,{onError:e=>{var t;console.log(null!==(t=e.message)&&void 0!==t?t:e.shortMessage),L.destroy(),L.open({type:"error",content:e.shortMessage})},onSuccess:async e=>await O(e)})},title:"NFT Details",okText:A?"Save New Listing Price":"Buy NFT",cancelText:"Leave it",centered:!0,confirmLoading:E||F,destroyOnClose:!0,children:(0,a.jsx)("div",{style:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("p",{className:"p-4 text-lg",children:A?"This is your listing. You may either update the listing price or cancel it.":"You can buy this NFT"}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2 border-solid border-2 border-gray-400 rounded p-2 w-fit",children:[(0,a.jsxs)("div",{children:["#",n]}),k?(0,a.jsx)(l.Z,{alt:"nft",src:k,height:200,width:200}):(0,a.jsx)(u.Z.Image,{}),(0,a.jsxs)("div",{className:"font-bold",children:[(0,y.b)(w||0,18)," ETH"]})]}),A&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500 flex-shrink-0",children:"Update listing price in L1 Currency (ETH)ï¼š"}),(0,a.jsx)(f.Z,{min:0,onChange:e=>{I(e)},size:"large",addonAfter:"ETH",disabled:E||F})]}),A&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 flex-shrink-0",children:"or "}),(0,a.jsx)(g.ZP,{disabled:E||F,type:"primary",size:"large",onClick:()=>{L.open({type:"loading",content:"Wait for confirming...",duration:0}),P(Z,{onError:e=>{var t;console.log(null!==(t=e.message)&&void 0!==t?t:e.shortMessage),L.destroy(),L.open({type:"error",content:e.shortMessage})},onSuccess:async e=>await W(e)})},children:"Cancel Listing"})]})]})})})]})}let k=(e,t)=>{if(e.length<=t)return e;let n=t-3;return e.substring(0,Math.ceil(n/2))+"..."+e.substring(e.length-Math.floor(n/2))};function w(e){let{price:t,nftAddress:n,tokenId:c,marketplaceAddress:m,seller:f}=e,{isConnected:g,address:x}=(0,s.m)();(0,h.x)();let[T,b]=(0,d.useState)(""),[w,M]=(0,d.useState)(""),[N,I]=(0,d.useState)(""),[j,A]=(0,d.useState)(!1),{Meta:_}=p.default;async function L(){let e=await (0,o.L)(r.v,{abi:i.abiERC721,address:n,functionName:"tokenURI",args:[c]});if(e){console.log("The token URI is: ".concat(e));let t=e.replace("ipfs://","https://ipfs.io/ipfs/"),n=await (await fetch(t)).json();console.log(n);let a=n.image.replace("ipfs://","https://ipfs.io/ipfs/");console.log(a),b(a),M(n.name),I(n.description)}}(0,d.useEffect)(()=>{g&&L()},[g]);let C=f.toLowerCase()===x.toLowerCase()?"You":k(f,12);return(0,a.jsx)("div",{children:(0,a.jsx)("div",{children:T?(0,a.jsxs)("div",{children:[(0,a.jsx)(v,{isVisible:j,tokenId:c,nftAddress:n,marketplaceAddress:m,onClose:()=>A(!1),imageURL:T,currentPrice:t,seller:f}),(0,a.jsxs)(p.default,{hoverable:!0,cover:(0,a.jsx)(l.Z,{alt:"nft",src:T,height:200,width:200,preview:!1}),onClick:()=>{A(!0)},children:[(0,a.jsx)(_,{title:w,description:N}),(0,a.jsx)("div",{className:" p-2",children:(0,a.jsxs)("div",{className:" flex flex-col items-end gap-2",children:[(0,a.jsxs)("div",{children:["#",c]}),(0,a.jsxs)("div",{className:"italic text-sm",children:["Owned by ",C]}),(0,a.jsxs)("div",{className:" font-bold",children:[(0,y.b)(t,18)," ETH"]})]})})]})]}):(0,a.jsx)("div",{children:(0,a.jsx)(u.Z.Image,{})})})})}var M=n(48646);function N(){let e=(0,M._)(['\n    {\n        activeItems(first: 5, where: { buyer: "0x0000000000000000000000000000000000000000" }) {\n            id\n            buyer\n            seller\n            nftAddress\n            tokenId\n            price\n        }\n    }\n']);return N=function(){return e},e}let I=(0,n(21432).Ps)(N());var j=n(56884);function A(){let{isConnected:e,isDisconnected:t}=(0,s.m)(),n=(0,h.x)(),r=n in i.networkMappingAddresses?i.networkMappingAddresses[n].NftMarketplace[0]:null,{loading:o,error:d,data:p}=(0,j.a)(I);return console.log(p),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:" flex flex-col items-center justify-center h-screen space-y-10",children:[(0,a.jsxs)("h1",{className:" text-4xl font-mono font-bold",children:[t&&"Connet your wallet (with sepolia nerwork)",e&&11155111!=n&&"Please switch to sepolia nerwork"]}),e&&11155111==n&&(0,a.jsx)("div",{className:"flex flex-wrap",children:o||!p?(0,a.jsx)("div",{children:"Loading..."}):p.activeItems.map(e=>{let{price:t,nftAddress:n,tokenId:s,seller:i}=e;return r?(0,a.jsx)(w,{price:t,nftAddress:n,tokenId:s,marketplaceAddress:r,seller:i},"".concat(n).concat(s)):(0,a.jsx)("div",{children:"Network error, please switch to a supported network. "})})})]})})}},24717:function(e){"use strict";e.exports=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"balance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"operator","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"owner","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"_approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},85061:function(e){"use strict";e.exports=JSON.parse('[{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"NftMarketplace__AlreadyListed","type":"error"},{"inputs":[],"name":"NftMarketplace__NoProceeds","type":"error"},{"inputs":[],"name":"NftMarketplace__NotApprovedForMarketplace","type":"error"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"NftMarketplace__NotListed","type":"error"},{"inputs":[],"name":"NftMarketplace__NotOwner","type":"error"},{"inputs":[],"name":"NftMarketplace__PriceMustBeAboveZero","type":"error"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"price","type":"uint256"}],"name":"NftMarketplace__PriceNotMet","type":"error"},{"inputs":[],"name":"NftMarketplace__TransferFailed","type":"error"},{"inputs":[],"name":"ReentrancyGuardReentrantCall","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"buyer","type":"address"},{"indexed":true,"internalType":"address","name":"nftAddress","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"}],"name":"ItemBought","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"seller","type":"address"},{"indexed":true,"internalType":"address","name":"nftAddress","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ItemCanceled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"seller","type":"address"},{"indexed":true,"internalType":"address","name":"nftAddress","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"}],"name":"ItemListed","type":"event"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"buyItem","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"cancelListing","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getListing","outputs":[{"components":[{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"address","name":"seller","type":"address"}],"internalType":"struct NftMarketplace.Listing","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"seller","type":"address"}],"name":"getProceeds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"price","type":"uint256"}],"name":"listItem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"nftAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"newPrice","type":"uint256"}],"name":"updateListing","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawProceeds","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},17076:function(e){"use strict";e.exports=JSON.parse('{"31337":{"NftMarketplace":["0x5FbDB2315678afecb367f032d93F642f64180aa3"]},"11155111":{"NftMarketplace":["0x0c951b6fFEaD58D44f2149B361a1fe08BE3f1695"]}}')}},function(e){e.O(0,[6908,6323,6790,2909,2510,6294,2971,7023,1744],function(){return e(e.s=58324)}),_N_E=e.O()}]);